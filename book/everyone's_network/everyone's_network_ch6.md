# 책 <모두의 네트워크> 개념정리
## 6. 전송계층: 신뢰할 수 있는 데이터 전송하기
- 전송 계층의 역할을 이해한다
- 연결형 통신과 비연결형 통신을 이해한다
- TCP를 이해한다
- UDP를 이해한다

### Lesson23
- 물리계층, 데이터 링크 계층, 네트워크 계층이 있으면 목적지에 데이터를 보낼 수 있음!
- BUT 데이터가 손상되거나 유실되더라도 이 3개의 계층에서는 Do Nothing!
- `전송계층`: 목적지에 신뢰할 수 있는 데이터를 전달하기 위해 필요함
- 기능 1) 오류를 점검하는 기능 => 오류가 발생하면 데이터를 재전송하도록 요청함
- 기능2) 애플리케이션 식별 기능 => 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별함
- 전송계층의 특징: `신뢰성/정확성`, `효율성`
- `신뢰성/정확성`: 데이터를 목적지에 문제없이 전달하는 것 => 연결형 통신
- `효율성`: 데이터를 빠르고 효율적으로 전달하는 것 => 비연결형 통신
- `연결형 통신`: 상대편과 확인해가며 통신하는 방식, 신뢰성/정확성 우선 => `TCP`프로토콜 사용
- `비연결형 통신`: 상대편을 확인하지 않고 일방적으로 데이터를 보내는 방식, 효율성 우선 ex) 동영상 => `UDP`프로토콜 사용

### Lesson24
- `TCP 프로토콜`: 전송 계층에서 신뢰할 수 있는 정확한 통신을 제공함
- `캡슐화`: 응용계층부터 물리계층까지 계층별로 데이터를 전달할 때 헤더를 붙이는 것
- `역캡슐화`: 데이터 수신측에서 물리 계층부터 응용 계층까지 계층별로 데이터를 전달할 때 헤더를 제거하는 것
- `TCP헤더`: TCP로 전송할 때 붙이는 헤더
- `세그먼트(segment)`: TCP헤더가 붙은 데이터
- 데이터를 전송하기 전에 `연결(connection)`이라는 가상의 독점 통신로를 확보해야 함. `연결`을 확입한 후에 데이터를 전송할 수 있음
- TCP헤더의 `코드 비트`부분: 107번 비트부터 112번째 비트까지의 6비트로, 연결의 제어 정보가 기록되는 곳
- `코드비트`: 초기값은 0, 비트가 활성화되면 1이 됨. 연결을 확립하려면 `SYN(연결요청)`과 `ACK(확인응답)`가 필요함
- `3-way 핸드셰이크`: 데이터를 보내기 전에 연결을 확립하기 위해 패킷 요청을 세번 교환하는 것. 확실하게 데이터가 전송되었$는지 확인하면서 이루어지는 통신 수단.
- 연결을 확립할 때: `SYN(연결 요청)`, `ACK(확인응답)`를 사용함
- 연결이 끊겨졌을 때: `FIN(연결 종료)`, `ACK(확인응답)`를 사용함

### Lesson25
- 3-way 핸드셰이크가 끝난 뒤, 실제 데이터를 보내거나 상대방이 받을 때: `TCP헤더`의 `일련번호(sequence number)`와 `확인응답번호(acknowledgement number)`를 사용함
- 1) `TCP`는 데이터를 분할해서 보냄.
- 2)`일련번호`는 송신 측에서 수신측에 "이 데이터가 몇 번째 데이터인지" 알려주는 역할.
- 3) `확인 응답 번호`는 수신 측이 몇 번째 데이터를 수신했는지 송신 측에 알려주는 역할. 다음 번호의 데이터를 요청하는데도 사용됨. 
- `재전송 제어`: 데이터가 항상 올바르게 전달되는 것은 아니므로, `일련번호`와 `확인응답번호`를 사용해서 데이터가 손상되거나 유실된 경우에 데이터를 재전송하게 되어있음
- 데이터를 전송하는 도중에 오류가 발생하면 일정 시간 동안 대기한 후, 재전송

- 세그먼트(데이터)를 하나 보낼 때 마다 확인 응답을 한 번 반환하는 통신은 효율이 낮음. => 매번 확인 응답을 기다리는 대신, 세그먼트를 연속으로 보내놓고 난 다음 확인응답을 반환하여 효율을 높임.
- `버퍼(buffer)`: 받은 세그먼트를 일시적으로 보관하는 장소 
=> 세그먼트를 연속으로 보내도 수신 측이 대응할 수 있고, 확인응답 효율도 높아짐
- `오버플로우`: 수신 측은 대량으로 데이터가 전송되면 보관하지 못하고 넘침
- 오버프로우 방지: `버퍼의 한계 크기`알고 있어야!: `TCP헤더`의 `윈도우 크기(window size)` 값
- `윈도우크기`: 얼마나 많은 용량의 데이터를 저장해둘 수 있는지 나타내는 값. (= 확인 응답을 일일이 하지 않고 연속해서 송수신할 수 있는 데이터 크기)
- 윈도우 크기의 초기값은 `3-way 핸드세이크`할 때 판단함

### Lesson26
- `포트 번호`: 데이터의 목적지가 어떤 애플리케이션(웹 브라우저나 메일 프로그램 등)인지 구분하는 역할, 0~65535번 사용
- `TCP헤더`의 `출발지 포트 번호`, `목적지 포트 번호`로 프로그램 구분
- 포트번호 0~1023: 주요 프로토콜이 사용하도록 예약되어 있음: 잘 알려진 포트(well-known port). 서버측 애플리케이션에서 사용됨
- 1024포트: 예약되어 있지만 사용되지 않는 포트
- 1025번 이상 포트: 랜덤포트, 클라이언트 측의 송신 포트
- SSH(22번포트)/SMTP(25번포트)/DNS(53번포트)/HTTP(80번포트)/POP3(110번포트)/HTTPS(443번포트)
- 데이터를 전송할 때는 상대방의 `IP주소`가 필요, 어떤 애플리케이션이 사용되고 있는지 구분하려면 `TCP`는 `포트번호`가 필요
- 웹 브라우저로 접속할 때 웹 브라우저에는 임의의 포트가 자동으로 할당됨. 
=> 서버측에서는 포트 번호를 정해둬야 하지만, 클라이언트 측은 정하지 않아도 됨

### Lesson27
- `UDP`: 효율성을 중요하게 여기는 프로토콜 <-> TCP
- 장점: 데이터를 효율적으로 빠르게 보내는 것
=> ex) 스트리밍 방식으로 전송하는 동영상 서비스
- `UDP헤더`: 올바른 목적지의 애플리케이션으로 데이터를 전송하기 위해 필요한 정보가 기록되어 있음 
- 구성: 출발지 포트번호/목적지 포트번호/길이/체크섬
- `UDP 데이터그램`: `UDP헤더`가 있는 데이터
- `UDP`를 사용하면 랜이 있는 컴퓨터나 네트워크 장비에 데이터를 일괄적으로 보낼 수 있음. (목적지 관계없음) = `브로드캐스트(broadcast)`
- `TCP`는 3-way 핸드셰이크와 같이 데이터를 전송할 때도 확인 응답을 하나씩 보내야 함. => 불특정 다수에게 보내는 통신에는 적합하지 않음(ex.브로드캐스트). 목적지 지정해야함.